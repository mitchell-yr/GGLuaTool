# GGLuaTool

# *å¯»æ‰¾åˆä½œè€…ä¸­*ï¼ç›®å‰ä¸€ä¸ªäººå‘¨æœ«æŠ½ç©ºå†™æ•ˆç‡ä½ä¸‹ï¼Œæ€¥éœ€åˆä½œè€…ã€‚

# æ¬¢è¿è”ç³»ï¼š

# qq:2185125049

# email:mitchell0yr@gmail.com

## ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªæ‚ ç„¶åˆ¶ä½œçš„GGluaè„šæœ¬å·¥å…·ã€‚ç”¨äºç¼–å†™ã€ç¼–è¯‘ä¸åç¼–è¯‘ã€åŠ å¯†é€‚ç”¨äºGameGuardiançš„luaè„šæœ¬çš„å·¥å…·ã€‚  
æ­¤è½¯ä»¶ç›®å‰åªæœ‰éƒ¨åˆ†åŠŸèƒ½ï¼Œå°†åœ¨è¿‘æœŸåŠ å…¥æ›´å¤šåŠŸèƒ½ã€‚æ­£åœ¨æŒç»­æ›´æ–°ï¼

æ­¤è½¯ä»¶ç”±AndroidStudioä½¿ç”¨äº†javaåˆ¶ä½œã€‚

## ä¸»è¦äº‹é¡¹

è¯·éµå®ˆå¼€æºåè®®ï¼æ­¤è½¯ä»¶ä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨ï¼Œ**ç¦æ­¢ç”¨äºè¿æ³•ç”¨é€”**(å¦‚åˆ¶ä½œæ¸¸æˆå¤–æŒ‚ç­‰éæ³•ç”¨é€”)ï¼Œè‹¥é€ æˆä»»ä½•åæœä¸å¼€å‘è€…æ— å…³
æ­¤é¡¹ç›®ä½¿ç”¨äº†deepseekã€claudeã€geminiè¾…åŠ©ï¼Œè¯·æŒ‰ç…§ã€Šäººå·¥æ™ºèƒ½ç”Ÿæˆåˆæˆå†…å®¹æ ‡è¯†åŠæ³•ã€‹ç­‰æ³•è§„æ ‡è¯†ç”Ÿæˆå¼äººå·¥æ™ºèƒ½ä½¿ç”¨

## ä½¿ç”¨æ–¹æ³•

> - å¼€è¢‹å³é£Ÿï¼ˆbushiï¼‰
> - åœ¨Android Studioæ‰“å¼€ï¼Œæ³¨æ„gradleå’Œjavaç‰ˆæœ¬

#### ç›®å‰åŠŸèƒ½

- è„šæœ¬ç¼–è¾‘å™¨ï¼ˆåŸºäºsora-editorï¼Œæ”¯æŒä»£ç è¡¥å…¨ã€è¯­æ³•é«˜äº®ç­‰ç­‰ï¼‰
- æ”¯æŒä¸€ä»¶æ’å…¥è„šæœ¬æ¨¡æ¿
- æ„å»ºå‘è¡Œå“ï¼ˆå¯ä»¥ä¸€é”®ç”Ÿæˆå®šåˆ¶GGå®¢æˆ·ç«¯ï¼Œä¸”å¯è‡ªé€‰æ·»åŠ é™„åŠ å‡½æ•°å’Œå†…ç½®è„šæœ¬ï¼‰ï¼ˆè¯·å¼ºå¤§çš„å‡½æ•°æ·»åŠ å°†æ”¯æŒï¼Œæ·»åŠ å‡½æ•°åŒ…å…·ä½“æ ¼å¼è§ä»£ç ï¼Œç›®å‰æ”¯æŒscriptæ·»åŠ æ³•ï¼Œæä¾›äº†æµ‹è¯•å‡½æ•°åŒ…ä¾›å‚è€ƒï¼‰
- ä¸¤ç§luaå­—èŠ‚ç åç¼–è¯‘ï¼šunluacå’ŒTDï¼ˆunluacåŒ…é‡åˆ°æŠ€æœ¯æ€§é—®é¢˜æ­£åœ¨è§£å†³ä¸­ï¼‰ï¼ˆæœªæ¥å°†åŠ å…¥æ›´å¤šå·¥å…·ï¼‰
- æ”¯æŒç¼–è¯‘è„šæœ¬ï¼Œæ·»åŠ åŠ å¯†
- è¯­æ³•æ£€æŸ¥
- å¯è§†åŒ–luaç¼–è¾‘
- å†…ç½®æ”¯æŒggå‡½æ•°çš„luaè™šæ‹Ÿæœºï¼ˆå¯ç”¨äºè¿‡é˜²å¾¡ã€åæ£€æµ‹çš„è„šæœ¬å‡½æ•°è°ƒç”¨è‡ªåå’ŒåŠ¨æ€è°ƒè¯•ï¼Œæœªæ¥ä¼šåŠ å…¥æ’æ¡©ã€å˜é‡è¿½è¸ªç­‰ï¼‰
- #### æ³¨æ„ï¼šè¿™äº›æ›´æ–°éšæ—¶å¯èƒ½å˜åŠ¨
  
#### å³å°†æ”¯æŒåŠŸèƒ½
  
  - cppä¸€é”®ç”Ÿæˆã€ç¼–è¯‘ï¼ˆé‰´äºä½“é‡ï¼Œå¯èƒ½ä¼šå–æ¶ˆä¸€ä»¶ç¼–è¯‘ï¼‰
    
  - ä¸€é”®æ„å»ºç›´è£…ï¼ˆé•¿æœŸï¼‰

  - æ›´é«˜ç­‰çº§çš„åŠ å¯†
  
  - åŸºäºå†…ç½®luajçš„å³æ—¶åŠ¨æ€è°ƒè¯• 

  - å†…ç½®æ¡†æ¶ï¼ˆåŸºäºspacecoreï¼ˆå®‰å“9åˆ°14æ”¯æŒï¼‰ã€‚ç”±äºblackboxæ²¡åšå¥½ggé€‚é…ï¼Œä¼šåœ¨åç»­ç‰ˆæœ¬åŠ å…¥ã€‚å¦‚æœæœ‰æ›´å¥½çš„å¼€æºå…è´¹æ¡†æ¶æ¬¢è¿æ¨èï¼‰


### å¦‚ä½•ç»™luajè™šæ‹Ÿæœºæ·»åŠ \ä¿®æ”¹å‡½æ•°
### å¦‚ä½•åˆ¶ä½œGGä¿®æ”¹å™¨å‡½æ•°åŒ…

å‡½æ•°åŒ…ï¼ˆ.ggfuncï¼‰æ˜¯`å®šåˆ¶GGä¿®æ”¹å™¨`åŠŸèƒ½ä¸­ç”¨äºç»™ä¿®æ”¹å™¨çš„luajè™šæ‹Ÿæœºæ·»åŠ ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°çš„ï¼Œä¸€ä¸ªæ­£å¸¸çš„å‡½æ•°åŒ…ï¼ˆZIP ç»“æ„ï¼‰åº”è¯¥åŒ…å«ï¼š  

- funcpack.json          â€”â€” å…ƒæ•°æ®ï¼ˆå‡½æ•°åã€æè¿°ã€é€‚ç”¨ç‰ˆæœ¬ç­‰ï¼‰
- inner_96.smali         â€”â€” Script$xxx.smaliï¼ˆ96.0 ç‰ˆï¼Œå¯é€‰ï¼‰ï¼ˆxxxå†…å®¹å’Œåç§°ä¸€è‡´ï¼‰
- inner_101.smali        â€”â€” Script$xxx.smaliï¼ˆ101.1 ç‰ˆï¼Œå¯é€‰ï¼‰
- registration_96.smali  â€”â€” sleep ä¸‹æ–¹æ’å…¥çš„æ³¨å†Œä»£ç ï¼ˆ96.0 ç‰ˆï¼Œå¯é€‰ï¼‰
- registration_101.smali â€”â€” sleep ä¸‹æ–¹æ’å…¥çš„æ³¨å†Œä»£ç ï¼ˆ101.1 ç‰ˆï¼Œå¯é€‰ï¼‰

funcpack.json ç¤ºä¾‹ï¼š  

```json
 {
   "name": "åç§°",
   "description": "æè¿°",
   "version": "ä½¿ç”¨ç‰ˆæœ¬",
   "format_version": 1
 }
```

> version å­—æ®µå«ä¹‰ï¼š  
> "96"        â€” ä»…æœ‰ 96.0 ç‰ˆ smali  
> "101"       â€” ä»…æœ‰ 101.1 ç‰ˆ smali  
> "universal" â€” åŒæ—¶åŒ…å«ä¸¤ä¸ªç‰ˆæœ¬çš„ smali  

æˆ‘æä¾›äº†æµ‹è¯•å‡½æ•°åŒ…ä¾›å‚è€ƒã€‚

è¿è¡Œæ—¶æµç¨‹å¦‚ä¸‹ï¼š  
å°†inneræ·»åŠ åˆ°classå†…  
åœ¨Scriptç±»ä¸­å®šä½åˆ°sleepæ–¹æ³•æ³¨å†Œå¤„ï¼Œå¹¶åœ¨ä¸‹æ–¹æ·»åŠ registrationå†…çš„ä»£ç ç‰‡æ®µã€‚ä¼šè‡ªåŠ¨åˆ¤æ–­ç‰ˆæœ¬å¹¶æ³¨å…¥å¯¹åº”ç‰ˆæœ¬ä»£ç 
### ç¤¾åŒºåˆ†é¡µï¼ˆcommunityFragmentï¼‰
æœåŠ¡ç«¯æ¥å£æ–‡æ¡£ï¼ˆæ–¹ä¾¿æ­å»ºåç«¯ï¼‰  

è½®æ’­å›¾æ¥å£ GET /api/community/banners  
```JSON
{
"code": 0,
"data": [
{
"imageUrl": "http://ä½ çš„æœåŠ¡å™¨/images/banner1.jpg",
"linkUrl": "http://è·³è½¬é“¾æ¥",
"title": "è½®æ’­å›¾æ ‡é¢˜"
},
{
"imageUrl": "http://ä½ çš„æœåŠ¡å™¨/images/banner2.jpg",
"linkUrl": "",
"title": "ç¬¬äºŒå¼ è½®æ’­å›¾"
}
]
}
```
è„šæœ¬åˆ†äº«æ¥å£ GET /api/community/scripts
```JSON
{
"code": 0,
"data": [
{
"id": 1,
"title": "æŸæ¸¸æˆè„šæœ¬",
"desc": "æ”¯æŒæœ€æ–°ç‰ˆæœ¬ï¼Œä¸€é”®ä¿®æ”¹é‡‘å¸æ•°é‡",
"author": "å¼€å‘è€…A",
"tag": "çƒ­é—¨",
"date": "2024-01-15",
"url": "http://è¯¦æƒ…é“¾æ¥"
}
]
}
```
èµ„æºè·å–æ¥å£ GET /api/community/resources
```JSON
{
"code": 0,
"data": [
{
"id": 1,
"title": "GameGuardian v101.1",
"desc": "æœ€æ–°ç‰ˆGGä¿®æ”¹å™¨",
"iconUrl": "http://ä½ çš„æœåŠ¡å™¨/icons/gg.png",
"size": "15.2MB",
"downloadUrl": "http://ä¸‹è½½é“¾æ¥"
}
]
}
```
### å¦‚ä½•æ·»åŠ æ–°çš„ä»£ç å—ç±»å‹
#### 1. åœ¨ `CodeBlockType.java` ä¸­æ·»åŠ æ–°æšä¸¾

```java
public enum CodeBlockType {
    // ... ç°æœ‰ä»£ç å— ...
    
    // æ·»åŠ å†…å®¹

    
    
    // ... æ„é€ å‡½æ•°å’Œå…¶ä»–æ–¹æ³•ä¿æŒä¸å˜ ...
}
```

#### 2. åœ¨ `CodeBlockStructure.java` ä¸­å®šä¹‰ç»“æ„

åœ¨ `getStructure()` æ–¹æ³•çš„ `switch` è¯­å¥ä¸­æ·»åŠ ï¼š

```java
public static CodeBlockStructure getStructure(CodeBlockType type) {
    CodeBlockStructure structure = new CodeBlockStructure();

    switch (type) {
        // ... ç°æœ‰case ...
        
        // IOæ“ä½œ
        case FILE_OPEN:
            return structure.addLabel("æ‰“å¼€æ–‡ä»¶")
                    .addInput("æ–‡ä»¶å")
                    .addLabel("æ¨¡å¼")
                    .addInput("r/w/a");

        case FILE_READ:
            return structure.addLabel("è¯»å–æ–‡ä»¶å†…å®¹åˆ°")
                    .addInput("å˜é‡å");

        case FILE_WRITE:
            return structure.addLabel("å†™å…¥å†…å®¹")
                    .addInput("å†…å®¹");

        case FILE_CLOSE:
            return structure.addLabel("å…³é—­æ–‡ä»¶");

        default:
            return structure.addInput("å†…å®¹");
    }
}
```

#### 3. åœ¨ `generateCode()` æ–¹æ³•ä¸­æ·»åŠ ä»£ç ç”Ÿæˆé€»è¾‘

```java
public static String generateCode(CodeBlockType type, List<Part> parts) {
    StringBuilder code = new StringBuilder();

    switch (type) {
        // ... ç°æœ‰case ...
        
        // IOæ“ä½œ
        case FILE_OPEN:
            code.append("file, err = io.open(")
                    .append(getInputValue(parts, 0))
                    .append(", \"")
                    .append(getInputValue(parts, 1))
                    .append("\")");
            break;

        case FILE_READ:
            code.append(getInputValue(parts, 0))
                    .append(" = file:read(\"*a\")");
            break;

        case FILE_WRITE:
            code.append("file:write(")
                    .append(getInputValue(parts, 0))
                    .append(")");
            break;

        case FILE_CLOSE:
            code.append("file:close()");
            break;
            

        default:
            code.append(getInputValue(parts, 0));
            break;
    }

    return code.toString();
}
```

#### 4. åœ¨ `CodeBlockTypeItem.java` ä¸­æ·»åŠ åˆ†ç±»

åœ¨ `createAllCategories()` æ–¹æ³•ä¸­æ·»åŠ æ–°åˆ†ç±»ï¼š

```java
public static List<CodeBlockTypeItem> createAllCategories() {
    List<CodeBlockTypeItem> categories = new ArrayList<>();

    // ... ç°æœ‰åˆ†ç±» ...

    // IOæ“ä½œåˆ†ç±»
    CodeBlockTypeItem ioOps = new CodeBlockTypeItem("ğŸ“ æ–‡ä»¶IOæ“ä½œ");
    ioOps.addBlockType(CodeBlockType.FILE_OPEN);
    ioOps.addBlockType(CodeBlockType.FILE_READ);
    ioOps.addBlockType(CodeBlockType.FILE_WRITE);
    ioOps.addBlockType(CodeBlockType.FILE_CLOSE);
    categories.add(ioOps);


    return categories;
}
```

